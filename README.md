# PCA Visualizer

CSVデータを読み込み、主成分分析（PCA）を実行して結果をインタラクティブに可視化するためのGUIアプリケーションです。


<img width="1919" height="1006" alt="Image" src="https://github.com/user-attachments/assets/12813a19-38c1-4a54-b967-3a002c6b0383" />


## ✨ 機能

- ✅ **簡単な操作**: 3ステップ（ファイル選択 → 分析実行 → 結果確認）でPCAを実行できます。
- ✅ **CSV対応**: ヘッダー付きのCSVファイルをインポートできます。
- ✅ **自動前処理**: 数値データを自動で抽出し、標準化を行ってから分析します。
- ✅ **多角的な可視化**: 分析結果を3種類のグラフでタブ表示します。
  - **散布図**: 主成分スコアをプロット。カテゴリ別の色分けに対応。
 
    
   <img width="1541" height="877" alt="Image" src="https://github.com/user-attachments/assets/ec3e60c9-91f4-42f9-ba19-3b595c4c7ebb" />

  
  - **寄与率プロット**: 各主成分の重要度を可視化。
 
  
   <img width="1547" height="873" alt="Image" src="https://github.com/user-attachments/assets/e48781d9-425e-41af-9510-9520148792d5" />

  
  - **ローディングプロット**: 元変数の影響度を可視化。
 
    
   <img width="1543" height="871" alt="Image" src="https://github.com/user-attachments/assets/4e4817d4-1307-45b5-9625-a8d80d02ca8d" />

  
- ✅ **インタラクティブな散布図**: データ点にカーソルを合わせると詳細情報（ID、カテゴリなど）を表示。
- ✅ **柔軟なスタイル設定**: CSVに`category`列があれば、カテゴリ毎に点の色やマーカーを自由に変更可能。
- ✅ **結果のエクスポート**: 主成分スコアをIDやカテゴリ情報と共にCSVファイルとして保存できます。
- ✅ **ダークモード**:目に優しいダークテーマのUI。
- ✅ **簡単セットアップ**: 付属のバッチファイルが初回実行時に必要なライブラリを自動でインストールします。

## 🔧 使い方

### 必要なもの
- Python 3.x

### 実行手順

1.  **バッチファイル名の変更**
    `setup_and_run.txt` ファイルの名前を `setup_and_run.bat` に変更してください。

2.  **アプリケーションの起動**
    名前を変更した `setup_and_run.bat` をダブルクリックして実行します。
    - **初回実行時**: コマンドプロンプトが開き、仮想環境の構築と必要なライブラリ（`pandas`, `scikit-learn`, `matplotlib`, `mplcursors`）のインストールが自動的に始まります。完了まで数分かかることがあります。
    - **2回目以降**: すぐにアプリケーションが起動します。

3.  **CSVファイルの選択**
    - アプリケーションが起動したら、[**1. CSVファイルを選択**]ボタンをクリックします。
    - ファイルダイアログが開くので、分析したいCSVファイルを選択します。付属の `sample_pca_data.csv` を使って試すことができます。
    - ファイルを選択すると、左側の「スタイル設定」パネルに、CSVの `category` 列に基づいた設定項目が自動で表示されます。

4.  **分析の実行**
    - [**2. 分析実行**]ボタンをクリックします。
    - 分析が完了すると、右側のエリアに「PCA Scatter Plot」「Explained Variance」「Loadings Plot」の3つのタブが表示されます。

5.  **結果の確認とエクスポート**
    - 各タブをクリックして、分析結果のグラフを確認します。散布図では、点にカーソルを合わせると詳細が表示されます。
    - スタイル設定パネルで色やマーカーを変更し、再度[**2. 分析実行**]を押すと、変更がグラフに反映されます。
    - [**3. 結果をエクスポート**]ボタンをクリックすると、主成分スコアをCSVファイルとして保存できます。

## 📁 入力CSVファイルの形式

本ツールで正しく分析を行うために、CSVファイルは以下の形式にしてください。

- 1行目はヘッダー行である必要があります。
- **1列目**は、各データのユニークな**ID**として扱われます。（例: `Sample_01`, `ID-123`）
- 数値データが**2列以上**含まれている必要があります。これらがPCAの対象となります。
- （オプション） `category` という名前の列があると、その内容に基づいて散布図のデータ点が自動で色分け・グループ化され、スタイル設定が可能になります。

### `sample_pca_data.csv` の例

```csv
ID,sepal.length,sepal.width,petal.length,petal.width,category
1,5.1,3.5,1.4,0.2,Setosa
2,4.9,3,1.4,0.2,Setosa
3,4.7,3.2,1.3,0.2,Setosa
4,4.6,3.1,1.5,0.2,Setosa
5,5,3.6,1.4,0.2,Setosa
6,5.4,3.9,1.7,0.4,Setosa
7,4.6,3.4,1.4,0.3,Setosa
8,5,3.4,1.5,0.2,Setosa
```
- `ID`: IDとして扱われる
- `sepal.length`, `sepal.width`, `petal.length`, `petal.width`: PCAの分析対象となる数値データ
- `category`: スタイル設定と色分けに使われるカテゴリデータ

## 📚 付属ファイル

- `gui_pca_app.py`: このアプリケーションのメインのPythonスクリプトです。
- `setup_and_run.txt`: 起動と自動セットアップ用のWindowsバッチファイルです（`.bat`にリネームして使用）。
- `sample_pca_data.csv`: 動作確認用のサンプルデータです。

## 💻 技術的な詳細

- **GUI**: `Tkinter`
- **データ処理**: `Pandas`, `Numpy`
- **PCA**: `Scikit-learn`
- **グラフ描画**: `Matplotlib`
- **インタラクティブ機能**: `mplcursors`
