# PCA Visualizer

**主成分分析（PCA）を手軽に実行し、結果をインタラクティブに可視化するためのGUIツール**



## 概要

`PCA Visualizer`は、CSVファイル形式のデータを読み込み、主成分分析を実行して、その結果を視覚的に探索できるデスクトップアプリケーションです。データサイエンスの専門家でなくても、多次元データを直感的に理解し、データの中に潜むパターンや関係性を発見する手助けをします。

分析結果は、主要な主成分スコアと共にCSVファイルとしてエクスポートでき、さらなる分析やレポート作成に活用できます。

## ✨ 主な機能

*   **簡単な操作**: 3つのステップ（ファイル選択 → 分析実行 → 結果エクスポート）でPCAを実行できます。
*   **多彩な可視化**:
    *   **散布図**: 主成分1と主成分2でデータをプロットし、全体の分布を把握できます。
    *   **寄与率プロット**: 各主成分が元のデータの情報をどの程度説明しているかを確認できます。
    *   **ローディングプロット**: 元の変数が各主成分に与える影響の大きさと方向性を理解できます。
*   **インタラクティブなグラフ**:
    *   散布図上のデータポイントにカーソルを合わせると、そのデータのIDやカテゴリなどの詳細情報がポップアップ表示されます。
*   **カテゴリ別のスタイリング**:
    *   入力CSVに `category` 列が含まれている場合、カテゴリごとにプロットの色やマーカーを自由に変更できます。
*   **結果のエクスポート**:
    *   計算された主成分スコア（PC1, PC2, ...）を、元のIDやカテゴリ情報と合わせてCSVファイルとして保存できます。
*   **モダンなUI**:
    *   目に優しいダークモードを採用しています。

## 🖥️ 動作環境

*   **OS**: Windows 10 / 11
*   **Python**: 3.7 以上
    *   ※ `setup_and_run.bat` を使えば、Pythonがインストールされていれば自動で環境が構築されます。

## 🚀 使い方 (Windows)

Pythonの環境構築に詳しくない方でも、以下の手順で簡単にアプリケーションを起動できます。

1.  **ファイルのダウンロード**
    *   このリポジトリのファイルをすべてダウンロードし、同じフォルダに保存してください。
    *   必要なファイル: `gui_pca_app.py`, `setup_and_run.bat`

3.  **実行**
    *   名前を変更した `setup_and_run.bat` をダブルクリックして実行します。

4.  **初回セットアップ**
    *   初回実行時のみ、コマンドプロンプトが開き、必要なライブラリのインストールが自動的に行われます。これには数分かかることがあります。
    *   セットアップが完了すると、自動的にアプリケーションが起動します。

5.  **2回目以降の起動**
    *   `setup_and_run.bat` をダブルクリックするだけで、すぐにアプリケーションが起動します。

## 📂 入力CSVファイルの仕様

本ツールで分析するために、以下の仕様に沿ったCSVファイルをご用意ください。

*   1行目はヘッダー行（各列の名前）である必要があります。
*   ファイル内に**2つ以上の数値データ列**が含まれている必要があります。
*   最初の列は、各データを一意に識別するための**ID列**として扱われます（例: `Sample_ID`, `製品番号`など）。
*   （任意）`category` という名前の列があると、その列の値に基づいて散布図のデータが自動でグループ化され、色分けされます。

#### 入力CSVファイルの例 (`data.csv`)

```csv
SampleID,category,FeatureA,FeatureB,FeatureC,FeatureD
ID_001,GroupA,1.5,2.3,4.1,5.6
ID_002,GroupA,1.7,2.1,3.9,5.2
ID_003,GroupB,3.4,4.5,1.2,2.3
ID_004,GroupC,5.1,5.5,6.2,6.8
ID_005,GroupB,3.6,4.7,1.5,2.1
...
```

## 🍎 Mac / Linux ユーザーの方へ

`setup_and_run.bat`はWindows専用です。MacやLinuxをお使いの場合は、以下の手順で手動セットアップを行ってください。

```bash
# 1. リポジトリをクローンまたはダウンロード

# 2. プロジェクトディレクトリに移動
cd /path/to/project

# 3. 仮想環境を作成
python3 -m venv venv

# 4. 仮想環境を有効化
# Mac / Linux
source venv/bin/activate

# 5. 必要なライブラリをインストール
pip install pandas scikit-learn matplotlib mplcursors

# 6. アプリケーションを実行
python gui_pca_app.py
```

## 🛠️ 依存ライブラリ

このプロジェクトは以下のライブラリに依存しています。`setup_and_run.bat` を使用すれば自動でインストールされます。

*   `pandas`
*   `scikit-learn`
*   `matplotlib`
*   `mplcursors`

## 📄 ライセンス

このプロジェクトは [MIT License](LICENSE) の下で公開されています。
