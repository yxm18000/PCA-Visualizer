# PCA Visualizer

CSVファイルを読み込み、主成分分析（PCA）を実行して、結果を2次元の散布図でインタラクティブに可視化するGUIツールです。
異なる単位やスケールを持つ様々なCSVデータに対応できるよう、最も一般的で堅牢（ロバスト）な分析手法である**「中心化＋標準化」を適用した上で主成分分析**を行っています。

  
<img width="894" height="726" alt="Image" src="https://github.com/user-attachments/assets/ca66a5ba-549f-483f-8ec6-3f519e3d04cf" />

## 概要

このツールは、多くの特徴量（列）を持つ複雑な数値データを、人間が直感的に理解しやすい2次元のグラフに変換します。データの中に隠れたパターンやグループ、外れ値などを視覚的に発見する手助けをします。

特に、データに`category`という列が含まれている場合、カテゴリごとに点の色や形を変えてプロットするため、グループ間の分布の違いを簡単に比較できます。

## 主な機能

*   **簡単な操作**: GUI上でボタンをクリックするだけで、ファイルの選択から分析、可視化までを行えます。
*   **主成分分析**: 数値データを自動で抽出し、主成分分析（PCA）を実行します。
*   **インタラクティブな可視化**:
    *   分析結果を2次元の散布図で表示します。
    *   グラフ上の点にマウスカーソルを合わせると、元データの行番号やカテゴリなどの詳細情報が表示されます。
    *   グラフは拡大・縮小・移動・保存が可能です。
*   **カテゴリ別の色分け**: CSVファイルに`category`列があると、その値に応じて自動でプロットを色分け・マーカー分けします。

## 動作環境

*   **OS**: Windows
*   **必須**: Python 3.x がインストールされ、PATHが通っていること。
    *   *Pythonがインストールされていない場合は、[公式サイト](https://www.python.org/downloads/)からインストールしてください。インストール時に「Add Python to PATH」のチェックを必ず入れてください。*

## 使い方

### 1. 準備

1.  このプロジェクトのファイル（`gui_pca_app.py`と`setup_and_run.txt`）を同じフォルダにダウンロードします。

### 2. 実行

1.  `setup_and_run.bat` をダブルクリックして実行します。
2.  **初回実行時のみ**、必要なライブラリを自動でインストールするためのセットアップが始まります。コマンドプロンプト（黒い画面）が表示され、処理が完了するまで数分かかることがあります。
    *   *この処理にはインターネット接続が必要です。*
3.  セットアップが完了すると、自動的にPCA Visualizerのウィンドウが起動します。
    *   *2回目以降の実行時は、セットアップはスキップされ、すぐにアプリケーションが起動します。*

### 3. アプリの操作方法

1.  **「1. CSVファイルを選択」**ボタンをクリックし、分析したいCSVファイルを選択します。
2.  ファイル名がウィンドウに表示されたことを確認します。
3.  **「2. 分析実行」**ボタンをクリックします。
4.  分析と描画が完了すると、ウィンドウ下部にグラフが表示されます。

## 入力するCSVファイルの形式について

### 基本的な形式

*   文字コード: **UTF-8**
*   1行目は列名（ヘッダー）である必要があります。
*   分析対象となる**数値データ**（整数や小数）を含む列が2つ以上必要です。
*   数値以外のデータ（文字列など）が含まれる列は、分析からは自動的に除外されます。

### カテゴリによる色分け機能（推奨）

グラフ上の点をカテゴリ別に色分けしたい場合は、CSVファイルに `category` という名前の列を追加してください。

**サンプルCSV (`data.csv`):**
```csv
SampleID,SensorA,SensorB,SensorC,SensorD,category
S001,10.5,11.2,3.1,2.5,on
S002,9.8,10.5,2.9,3.3,on
S003,11.1,9.9,3.5,2.8,on
S004,10.2,10.8,3.0,3.1,on
S005,10.7,11.5,2.7,2.9,on
S006,3.2,2.5,10.1,9.5,off
S007,2.9,3.1,11.5,10.2,off
S008,3.5,2.8,9.8,10.8,off
S009,4.1,3.3,10.5,9.9,off
S010,3.8,2.9,10.9,11.1,off
S011,6.5,7.2,6.8,7.5,unknown
S012,7.1,6.8,7.2,6.9,unknown
S013,5.9,6.5,7.8,6.2,unknown
S014,1.1,8.5,8.1,1.5,standby
S015,1.5,8.2,7.9,1.8,standby
S016,1.3,8.8,8.5,1.6,standby
S017,10.1,2.1,9.5,9.2,anomaly
S018,9.5,2.5,9.1,8.9,anomaly
```
この例では、`category`列の値（'on', 'off', 'unknown'）に基づいて、プロットが色分け・マーカー分けされます。

## 注意事項

*   バッチファイル(`setup_and_run.bat`)はWindows専用です。
*   非常にサイズの大きいCSVファイル（数百万行など）を読み込むと、PCの性能によっては処理に時間がかかったり、メモリが不足したりする可能性があります。
*   セットアップ中にエラーが発生する場合は、Pythonが正しくインストールされPATHが通っているか、インターネットに接続されているかを確認してください。
